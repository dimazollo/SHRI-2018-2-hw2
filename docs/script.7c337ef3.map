{"version":3,"sources":["script/Point.js","script/Pointer.js","script/Gesture.js","script/index.js","../../../.config/yarn/global/node_modules/parcel-bundler/src/builtins/bundle-url.js","../../../.config/yarn/global/node_modules/parcel-bundler/src/builtins/css-loader.js"],"names":["Point","x","y","Math","sqrt","pow","Pointer","pointerId","id","startPoint","prevPoint","prevTs","Date","now","Gesture","pointers","translateParams","_scaleParams","_brightnessParams","prevPinchDistance","prevRotateAngle","event","type","handlePointerDown","handlePointerMove","handlePointerUp","handlePointerCancel","filter","item","length","push","currentPointer","getPointer","newPoint","delta","substract","add","secondPointer","pointer","handlePinch","handleRotate","update","releasePointer","array","Error","newPinchDistance","distanceTo","initialWidth","k","relativeSizeChange","scaleParams","vector","newRotateAngle","atan2","angleChange","brightnessParams","value","cameraContainer","document","querySelector","cameraImage","bar","scaleBlock","brightnessBlock","gesture","myPointer","initialImageWidth","offsetWidth","calcBarPosition","xTranslate","containerWidth","position","style","width","left","addEventListener","setPointerCapture","translate","backgroundPosition","scale","transform","brightness","textContent","floor","releasePointerCapture","bundleURL","getBundleURLCached","getBundleURL","err","matches","stack","match","getBaseURL","url","replace","exports","bundle","require","updateLink","link","newLink","cloneNode","onload","remove","href","split","parentNode","insertBefore","nextSibling","cssTimeout","reloadCSS","setTimeout","links","querySelectorAll","i","module"],"mappings":"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","file":"script.7c337ef3.map","sourceRoot":"../src","sourcesContent":["export default class Point {\n  constructor({x, y}) {\n    this.x = x;\n    this.y = y;\n  }\n\n  add ({x, y}) {\n    return new Point({x: this.x + x, y: this.y + y});\n  }\n\n  substract ({x, y}) {\n    return new Point({x: this.x - x, y: this.y - y});\n  }\n\n  distanceTo ({x, y}) {\n    return Math.sqrt(Math.pow(this.x - x, 2) + Math.pow(this.y - y, 2));\n  }\n}\n","import Point from './Point';\n\nexport default class Pointer {\n  // TODO - maybe should use { offsetX, offsetY } together or instead\n  constructor ({x, y, pointerId}) {\n    this.id = pointerId;\n    this.startPoint = new Point({x, y});\n    this.prevPoint = new Point({x, y});\n    this.prevTs = Date.now();\n  }\n\n  update({x, y, pointerId}) {\n    if (this.id === pointerId) {\n      this.prevPoint = new Point({x, y});\n      this.prevTs = Date.now();\n    }\n  }\n}\n","import Pointer from \"./Pointer\"\nimport Point from './Point';\n\nexport default class Gesture {\n  constructor() {\n    this.pointers = [];\n    this.translateParams = new Point({x: 0, y: 0});\n\n    this._scaleParams = 1.0;\n    this._brightnessParams = 1.0;\n\n    this.prevPinchDistance = null;\n    this.prevRotateAngle = null;\n\n  }\n\n  handlePointerEvent(event) {\n    switch (event.type) {\n      case 'pointerdown': this.handlePointerDown(event); break;\n      case 'pointermove': this.handlePointerMove(event); break;\n      case 'pointerup': this.handlePointerUp(event); break;\n      case 'pointercancel': this.handlePointerCancel(event); break;\n    }\n  }\n\n  handlePointerDown(event) {\n    if (this.pointers.filter(item => item.id === event.pointerId).length === 0) {\n      this.pointers.push(new Pointer(event));\n    }\n  }\n\n  handlePointerMove(event) {\n    const currentPointer = this.getPointer(event);\n\n    if (currentPointer == null) {\n      // currentPointer.update(event);\n      return;\n    } else {\n\n      if (this.pointers.length === 1) {\n        const newPoint = new Point(event);\n        const delta = newPoint.substract(currentPointer.prevPoint);\n        this.translateParams = this.translateParams.add(delta);\n\n      } else if (this.pointers.length === 2) {\n        const secondPointer = this.pointers\n          .filter(pointer => pointer.id !== event.pointerId)[0];\n\n        this.handlePinch(currentPointer, secondPointer);\n\n        // rotate\n        this.handleRotate(this.pointers[0], this.pointers[1]);\n      }\n      // update relevant pointer with event coordinates\n      currentPointer.update(event);\n    }\n  }\n\n  handlePointerUp(event) {\n    this.releasePointer(event)\n  }\n\n  handlePointerCancel(event) {\n    this.releasePointer(event)\n  }\n\n  releasePointer ({ pointerId }) {\n    this.pointers = this.pointers.filter(pointer => pointer.id !== pointerId);\n    if (this.pointers.length < 2) {\n      this.prevPinchDistance = null;\n      this.prevRotateAngle = null;\n    }\n  }\n\n  getPointer({ pointerId }) {\n    const array = this.pointers.filter(pointer => pointer.id === pointerId);\n    if (array.length === 1) {\n      return array[0];\n    } else if (array.length < 1) {\n      return null;\n    } else if (array.length > 1) {\n      throw new Error('unique pointer was registered twice');\n    }\n  }\n\n  handlePinch(currentPointer, secondPointer) {\n    const newPinchDistance = currentPointer\n      .prevPoint.distanceTo(secondPointer.prevPoint);\n\n    if (this.prevPinchDistance) {\n      const delta = newPinchDistance - this.prevPinchDistance;\n      const initialWidth = 2560;\n\n      const k = 5; // magic coefficient to make scale faster;\n      const relativeSizeChange = k * delta / initialWidth;\n\n      this.scaleParams += relativeSizeChange;\n    }\n    // update prevPinchDistance\n    this.prevPinchDistance = newPinchDistance;\n  }\n\n  handleRotate(currentPointer, secondPointer) {\n    const vector = currentPointer.prevPoint.substract(secondPointer.prevPoint);\n    const newRotateAngle = Math.atan2(vector.y, vector.x);\n\n    if (this.prevRotateAngle) {\n      const delta = newRotateAngle - this.prevRotateAngle;\n\n      const k = 0.2;// magic coefficient to slow change of brightness\n      const angleChange = k * delta;\n\n      this.brightnessParams += angleChange;\n    }\n\n    this.prevRotateAngle = newRotateAngle;\n  }\n\n  get scaleParams() {\n    return this._scaleParams;\n  }\n\n  set scaleParams(value) {\n    if (value > 0.3 && value < 2) {\n      this._scaleParams = value;\n    }\n  }\n\n  get brightnessParams() {\n    return this._brightnessParams;\n  }\n\n  set brightnessParams(value) {\n    if (value > 0.5 && value < 2) {\n      this._brightnessParams = value;\n    }\n  }\n\n}\n","import classes from '../style/style.css';\nimport Gesture from './Gesture';\nimport Point from './Point';\n\nconst cameraContainer = document.querySelector('.camera-view__container');\nconst cameraImage = document.querySelector('.camera-view__image');\nconst bar = document.querySelector('.bar');\n\nconst scaleBlock = document.querySelector('#scale');\nconst brightnessBlock = document.querySelector('#brightness');\n\nconst gesture = new Gesture();\n\n// FAKE pointer for debugging\nconst myPointer = {\n  id: 10000,\n  startPoint: new Point({x: 400, y: 250}),\n  prevPoint: new Point({x: 400, y: 250}),\n  prevTs: Date.now()\n};\n// gesture.pointers.push(myPointer);\n\nconst initialImageWidth = cameraImage.offsetWidth;\n\nfunction calcBarPosition() {\n  const xTranslate = gesture.translateParams.x;\n  const containerWidth = cameraContainer.offsetWidth;\n  const position = ((initialImageWidth / 2 + xTranslate)\n    / initialImageWidth * containerWidth - bar.style.width / 2) % containerWidth;\n\n  if (position < 0) {\n    return position + containerWidth\n  } else {\n    return position;\n  }\n}\n\nbar.style.left = calcBarPosition() + 'px';\n\ncameraImage.addEventListener('pointerdown', (event) => {\n  cameraImage.setPointerCapture(event.pointerId);\n  gesture.handlePointerDown(event);\n});\n\ncameraImage.addEventListener('pointermove', (event) => {\n  gesture.handlePointerMove(event);\n\n  const translate = gesture.translateParams;\n  cameraImage.style.backgroundPosition = `${translate.x}px ${translate.y}px`;\n\n  const scale = gesture.scaleParams;\n  cameraImage.style.transform = `scale(${scale})`;\n\n  const brightness = gesture.brightnessParams;\n  cameraImage.style.filter = `brightness(${brightness})`;\n\n  bar.style.left = calcBarPosition() + 'px';\n\n  scaleBlock.textContent = Math.floor(scale * 100) + '%';\n  brightnessBlock.textContent = Math.floor(brightness * 100) + '%';\n});\n\ncameraImage.addEventListener('pointerup', (event) => {\n  gesture.handlePointerUp(event);\n  cameraImage.releasePointerCapture(event.pointerId);\n});\n\ncameraImage.addEventListener('pointercancel', (event) => {\n  gesture.handlePointerCancel(event);\n  cameraImage.releasePointerCapture(event.pointerId);\n});\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}